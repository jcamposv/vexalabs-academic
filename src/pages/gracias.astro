---
import AcademicLayout from '../layouts/AcademicLayout.astro';
import Button from '../components/Button.astro';
---

<AcademicLayout
  title="¡Muchas gracias por tu compra! — Vibe Coding Live"
  description="Tu lugar está reservado. Te enviamos un correo con todos los detalles."
>
  <main class="flex min-h-screen items-center justify-center px-4 py-16 relative overflow-hidden">
    <!-- Background glow -->
    <div class="pointer-events-none absolute inset-0">
      <div class="absolute left-1/2 top-1/3 -translate-x-1/2 -translate-y-1/2 h-[500px] w-[500px] rounded-full bg-brand-500/10 blur-[120px]"></div>
    </div>

    <div class="relative mx-auto max-w-lg text-center animate-fade-up">
      <!-- Logo -->
      <div class="mb-8 flex justify-center">
        <img
          src="/logo-vexalabs-academy.svg"
          alt="VexaLabs Academy"
          class="h-10"
        />
      </div>

      <!-- Success icon -->
      <div class="mx-auto mb-6 flex h-24 w-24 items-center justify-center rounded-full bg-brand-500/15 ring-2 ring-brand-500/30 animate-fade-in">
        <svg class="h-12 w-12 text-brand-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 12.75l6 6 9-13.5" />
        </svg>
      </div>

      <!-- Heading -->
      <h1 class="text-3xl font-extrabold tracking-tight sm:text-4xl md:text-5xl">
        <span class="text-brand-500">¡Muchas gracias</span><br />
        por tu compra!
      </h1>

      <!-- Description -->
      <p class="mt-4 text-lg text-text-muted leading-relaxed animate-fade-in delay-100">
        Tu lugar en <span class="font-semibold text-text">Vibe Coding Live</span> está confirmado.
        Te hemos enviado un <span class="font-semibold text-brand-400">correo electrónico</span> con todos los detalles de acceso.
      </p>

      <!-- Email notice card -->
      <div class="mt-8 rounded-2xl border border-brand-500/20 bg-brand-50 p-6 animate-fade-in delay-200">
        <div class="flex items-center justify-center gap-3 mb-3">
          <svg class="h-6 w-6 text-brand-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.5" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75" />
          </svg>
          <p class="text-sm font-bold text-text">Revisá tu bandeja de entrada</p>
        </div>
        <p class="text-sm text-text-muted leading-relaxed">
          En tu correo encontrarás la confirmación de pago, el acceso al Discord y toda la información del curso. Si no lo ves, revisá la carpeta de spam.
        </p>
      </div>

      <!-- Next steps -->
      <div class="mt-6 rounded-2xl border border-border bg-surface-alt p-6 animate-fade-in delay-300">
        <p class="text-sm font-semibold text-text mb-4">Próximos pasos:</p>
        <ul class="space-y-4 text-left">
          <li class="flex items-start gap-3">
            <span class="flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-brand-500/15 text-xs font-bold text-brand-500">1</span>
            <div>
              <p class="text-sm font-medium text-text">Revisá tu email</p>
              <p class="text-xs text-text-muted">Confirmación de pago + link de Discord</p>
            </div>
          </li>
          <li class="flex items-start gap-3">
            <span class="flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-brand-500/15 text-xs font-bold text-brand-500">2</span>
            <div>
              <p class="text-sm font-medium text-text">Uníte al Discord</p>
              <p class="text-xs text-text-muted">Conectá con la comunidad antes de iniciar</p>
            </div>
          </li>
          <li class="flex items-start gap-3">
            <span class="flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-brand-500/15 text-xs font-bold text-brand-500">3</span>
            <div>
              <p class="text-sm font-medium text-text">Nos vemos el lunes 16 de marzo</p>
              <p class="text-xs text-text-muted">7:00 PM (Costa Rica) — Primera sesión en vivo</p>
            </div>
          </li>
        </ul>
      </div>

      <!-- CTA -->
      <div class="mt-8 flex flex-col items-center gap-3 animate-fade-in delay-400">
        <Button href="/" variant="secondary" size="lg">Volver al inicio</Button>
        <p class="text-xs text-text-muted">
          ¿Preguntas? Escribinos a <a href="mailto:jairo@vexalabs.co" class="text-brand-400 hover:text-brand-500 underline underline-offset-2">jairo@vexalabs.co</a>
        </p>
      </div>
    </div>

    <!-- Confetti canvas -->
    <canvas id="confetti-canvas" class="pointer-events-none fixed inset-0 z-50" aria-hidden="true"></canvas>
  </main>
</AcademicLayout>

<!-- Fire Facebook Purchase event -->
<script is:inline>
  if (typeof fbq !== 'undefined') {
    var params = new URLSearchParams(window.location.search);
    var value = parseFloat(params.get('amount') || '149');
    fbq('track', 'Purchase', {
      value: value,
      currency: 'USD',
      content_name: 'Vibe Coding Live',
    });
  }
</script>

<!-- Confetti animation -->
<script is:inline>
  (function () {
    var canvas = document.getElementById('confetti-canvas');
    if (!canvas) return;
    var ctx = canvas.getContext('2d');
    if (!ctx) return;

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    var colors = ['#4ade80', '#22c55e', '#86efac', '#bbf7d0', '#f1f3f5', '#4ade80'];
    var particles = [];

    for (var i = 0; i < 100; i++) {
      particles.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height - canvas.height,
        w: Math.random() * 8 + 4,
        h: Math.random() * 4 + 2,
        color: colors[Math.floor(Math.random() * colors.length)],
        vx: (Math.random() - 0.5) * 3,
        vy: Math.random() * 3 + 2,
        rot: Math.random() * 360,
        rotSpeed: (Math.random() - 0.5) * 10,
        opacity: 1,
      });
    }

    var frame = 0;
    var maxFrames = 180;

    function animate() {
      if (frame > maxFrames) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        return;
      }
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      var fadeStart = maxFrames * 0.7;

      for (var i = 0; i < particles.length; i++) {
        var p = particles[i];
        p.x += p.vx;
        p.y += p.vy;
        p.rot += p.rotSpeed;
        if (frame > fadeStart) {
          p.opacity = Math.max(0, 1 - (frame - fadeStart) / (maxFrames - fadeStart));
        }

        ctx.save();
        ctx.translate(p.x, p.y);
        ctx.rotate((p.rot * Math.PI) / 180);
        ctx.globalAlpha = p.opacity;
        ctx.fillStyle = p.color;
        ctx.fillRect(-p.w / 2, -p.h / 2, p.w, p.h);
        ctx.restore();
      }

      frame++;
      requestAnimationFrame(animate);
    }

    animate();

    window.addEventListener('resize', function () {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    });
  })();
</script>
